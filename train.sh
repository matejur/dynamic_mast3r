torchrun --nproc_per_node=1 train.py \
    --train_dataset "50_000 @ PointOdyssey(root='data/point_odyssey', split='sample', resolution=[(256, 256), (256, 192), (256, 168), (256, 128), (512, 256)], strides=[1,2,3,4,5,6,7,8,9], aug_crop='auto', aug_monocular=0.005, transform=ColorJitter, n_corres=1024) + 50_000 @ Kubric(root='data/panning_movi_e_point_tracking', split='train', resolution=[(256, 256), (256, 192), (256, 168), (256, 128), (512, 256)], strides=[1,2,3,4,5,6,7,8,9], aug_crop='auto', aug_monocular=0.005, transform=ColorJitter, n_corres=1024)" \
    --test_dataset "500 @ PointOdyssey(root='data/point_odyssey', split='test', resolution=[(256, 256), (256, 192), (256, 168), (256, 128), (512, 256)], strides=[1,2,3,4,5,6,7,8,9], aug_crop='auto', aug_monocular=0.005, transform=ColorJitter, n_corres=1024) + 500 @ Kubric(root='data/panning_movi_e_point_tracking', split='test', resolution=[(256, 256), (256, 192), (256, 168), (256, 128), (512, 256)], strides=[1,2,3,4,5,6,7,8,9], aug_crop='auto', aug_monocular=0.005, transform=ColorJitter, n_corres=1024)"  \
    --model "AsymmetricMASt3R(pos_embed='RoPE100', patch_embed_cls='ManyAR_PatchEmbed', img_size=(512, 512), head_type='catmlp+dpt', output_mode='pts3d+desc24', depth_mode=('exp', -inf, inf), conf_mode=('exp', 1, inf), enc_embed_dim=1024, enc_depth=24, enc_num_heads=16, dec_embed_dim=768, dec_depth=12, dec_num_heads=12, two_confs=True, desc_conf_mode=('exp', 0, inf))" \
    --train_criterion "ConfLoss(Regr3D(L21, norm_mode='?avg_dis'), alpha=0.2) + 0.075*ConfMatchingLoss(MatchingLoss(InfoNCE(mode='proper', temperature=0.05), negatives_padding=0, blocksize=8192), alpha=10.0, confmode='mean')" \
    --test_criterion "Regr3D_ScaleShiftInv(L21, norm_mode='?avg_dis', gt_scale=True, sky_loss_value=0) + -1.*MatchingLoss(APLoss(nq='torch', fp=torch.float16), negatives_padding=12288)" \
    --pretrained "checkpoints/MASt3R_ViTLarge_BaseDecoder_512_catmlpdpt_metric.pth" \
    --lr 0.0001 --min_lr 1e-06 --warmup_epochs 1 --epochs 10 --batch_size 1 --accum_iter 2 \
    --save_freq 1 --keep_freq 5 --eval_freq 1 --print_freq=10 --disable_cudnn_benchmark \
    --output_dir "checkpoints/Dynamic_MASt3R"